---
title: 重み付きマッチング (一般グラフ)
documentation_of: ../../src/Optimization/WeightedMatching.hpp
---

一般グラフにおける重み付きマッチングを求める。Blossom Algorithm に基づく実装。

テンプレートパラメータ `cost_t` は辺の重みの型（整数、実数など）を指定する。
第2引数 `min_perfect` によって、求めるマッチングの種類を切り替える。
- `min_perfect = false` (デフォルト): **最大重みマッチング** を求める。マッチングは必ずしも完全ではない。
- `min_perfect = true`: **最小重み完全マッチング** を求める。頂点数が奇数の場合、完全マッチングは存在しない。

空間計算量が $O(V^2)$ であるため、頂点数 $V$ が大きいグラフには適用できない点に注意。

## メンバ関数

| 名前 | 概要 | 計算量 |
| -------------------- | ------------------------------------------------------------------------------------------------------------ | ------------------ |
| `WeightedMatching(N)` | 頂点数 N のグラフを構築する。 | $O(N^2)$ |
| `add_edge(u, v, w)` | 頂点 u と頂点 v の間に重み w の辺を追加する。 | $O(1)$ |
| `build()` | 追加された辺に基づいてマッチングを構築する。 | $O(V^3)$ |
| `match(v)` | 頂点 v のマッチング相手の頂点番号を返す。マッチングされていない場合は -1 を返す。 | $O(1)$ |
| `weight_matching()` | マッチング結果を `{u, v, w}` を要素とする `std::vector` として返す。<br>最小重み完全マッチングで解が存在しない場合は空のベクターを返す。 | $O(V)$ |


## Verify

- [幾何コンテスト2013 B - 玉座の間](https://atcoder.jp/contests/geocon2013/tasks/geocon2013_b) (二部グラフ, コスト実数, 最小重み完全マッチング)
- [AOJ 2923 - Airport](https://onlinejudge.u-aizu.ac.jp/problems/2923) (最大重みマッチング)
