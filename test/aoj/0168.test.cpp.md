---
data:
  _extendedDependsOn:
  - icon: ':question:'
    path: src/Math/bostan_mori.hpp
    title: "\u7DDA\u5F62\u6F38\u5316\u7684\u6570\u5217\u306E\u7B2C$k$\u9805"
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: false
  _pathExtension: cpp
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    '*NOT_SPECIAL_COMMENTS*': ''
    PROBLEM: https://onlinejudge.u-aizu.ac.jp/challenges/sources/PCK/Final/0168
    links:
    - https://onlinejudge.u-aizu.ac.jp/challenges/sources/PCK/Final/0168
  bundledCode: "#line 1 \"test/aoj/0168.test.cpp\"\n#define PROBLEM \"https://onlinejudge.u-aizu.ac.jp/challenges/sources/PCK/Final/0168\"\
    \n#include <iostream>\n#line 2 \"src/Math/bostan_mori.hpp\"\n#include <vector>\n\
    #include <cassert>\n#include <cstdint>\ntemplate <class K> K div_at(std::vector<K>\
    \ p, std::vector<K> q, uint64_t k) {\n int n= p.size() - 1, m= q.size() - 1;\n\
    \ for (assert(q[0] != K(0));; --n)\n  if (n < 0 || p[n] != K()) break;\n for (;;\
    \ --m)\n  if (m < 0 || q[m] != K()) break;\n const int l= std::max(n, m) + 1;\n\
    \ p.resize(l), q.resize(l);\n for (std::vector<K> np; k > m; q.swap(p), p.swap(np),\
    \ k>>= 1) {\n  np.assign(l, K());\n  if (k & 1) {\n   for (int i= 0; i < l; i+=\
    \ 2)\n    for (int j= 1; j < l; j+= 2) np[(i + j) >> 1]+= p[j] * q[i] - p[i] *\
    \ q[j];\n  } else {\n   for (int i= 0; i < l; i+= 2)\n    for (int j= 0; j < l;\
    \ j+= 2) np[(i + j) >> 1]+= p[i] * q[j];\n   for (int i= 1; i < l; i+= 2)\n  \
    \  for (int j= 1; j < l; j+= 2) np[(i + j) >> 1]-= p[i] * q[j];\n  }\n  p.assign(l,\
    \ K());\n  for (int i= 0; i < l; i+= 2)\n   for (int j= 0; j < i; j+= 2) p[(i\
    \ + j) >> 1]+= q[i] * q[j];\n  for (int i= 1; i < l; i+= 2)\n   for (int j= 1;\
    \ j < i; j+= 2) p[(i + j) >> 1]-= q[i] * q[j];\n  for (int i= l; i--;) p[i]+=\
    \ p[i];\n  for (int i= 0; i < l; i+= 2) p[i]+= q[i] * q[i];\n  for (int i= 1;\
    \ i < l; i+= 2) p[i]-= q[i] * q[i];\n }\n K iv= K(1) / q[0];\n for (int j= 0;\
    \ j <= k; p[j++]*= iv)\n  for (int i= j; i; --i) p[j]-= p[j - i] * q[i];\n return\
    \ p[k];\n}\n// a[n] = c[0] * a[n-1] + c[1] * a[n-2] + ... + c[d-1] * a[n-d]\n\
    // return a[k]\ntemplate <class K> K linear_recurrence(std::vector<K> c, const\
    \ std::vector<K> &a, uint64_t k) {\n if (k < a.size()) return a[k];\n const size_t\
    \ d= c.size();\n assert(d <= a.size());\n for (auto &x: c) x= -x;\n std::vector<K>\
    \ p(d);\n c.insert(c.begin(), K(1));\n for (int i= d; i--;)\n  for (int j= i;\
    \ j >= 0; --j) p[i]+= c[j] * a[i - j];\n return div_at<K>(p, c, k);\n}\n#line\
    \ 4 \"test/aoj/0168.test.cpp\"\nusing namespace std;\nsigned main() {\n cin.tie(0);\n\
    \ ios::sync_with_stdio(false);\n for (int n; cin >> n && n;) cout << (linear_recurrence<int>({1,\
    \ 1, 1}, {1, 1, 2}, n) + 3649) / 3650 << '\\n';\n return 0;\n}\n"
  code: "#define PROBLEM \"https://onlinejudge.u-aizu.ac.jp/challenges/sources/PCK/Final/0168\"\
    \n#include <iostream>\n#include \"src/Math/bostan_mori.hpp\"\nusing namespace\
    \ std;\nsigned main() {\n cin.tie(0);\n ios::sync_with_stdio(false);\n for (int\
    \ n; cin >> n && n;) cout << (linear_recurrence<int>({1, 1, 1}, {1, 1, 2}, n)\
    \ + 3649) / 3650 << '\\n';\n return 0;\n}\n"
  dependsOn:
  - src/Math/bostan_mori.hpp
  isVerificationFile: true
  path: test/aoj/0168.test.cpp
  requiredBy: []
  timestamp: '2024-02-22 16:45:01+09:00'
  verificationStatus: TEST_ACCEPTED
  verifiedWith: []
documentation_of: test/aoj/0168.test.cpp
layout: document
redirect_from:
- /verify/test/aoj/0168.test.cpp
- /verify/test/aoj/0168.test.cpp.html
title: test/aoj/0168.test.cpp
---
