---
data:
  _extendedDependsOn:
  - icon: ':heavy_check_mark:'
    path: src/DataStructure/BinaryIndexedTree.hpp
    title: Binary-Indexed-Tree
  - icon: ':question:'
    path: src/Misc/compress.hpp
    title: "\u5EA7\u6A19\u5727\u7E2E"
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: false
  _pathExtension: cpp
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    '*NOT_SPECIAL_COMMENTS*': ''
    PROBLEM: https://yukicoder.me/problems/no/738
    links:
    - https://yukicoder.me/problems/no/738
  bundledCode: "#line 1 \"test/yukicoder/738.BIT.test.cpp\"\n#define PROBLEM \"https://yukicoder.me/problems/no/738\"\
    \n#include <iostream>\n#include <vector>\n#line 3 \"src/Misc/compress.hpp\"\n\
    #include <algorithm>\ntemplate <class T> auto compress(std::vector<T> &v) {\n\
    \ return std::sort(v.begin(), v.end()), v.erase(std::unique(v.begin(), v.end()),\
    \ v.end()), [&v](T x) { return std::lower_bound(v.begin(), v.end(), x) - v.begin();\
    \ };\n}\n#line 4 \"src/DataStructure/BinaryIndexedTree.hpp\"\ntemplate <typename\
    \ T> class BinaryIndexedTree {\n std::vector<T> dat;\npublic:\n BinaryIndexedTree(int\
    \ n): dat(n + 1, T()) {}\n BinaryIndexedTree(int n, T a): BinaryIndexedTree(std::vector<T>(n,\
    \ a)) {}\n BinaryIndexedTree(const std::vector<T>& y): dat(y.size() + 1, 0) {\n\
    \  for (int i= y.size(); i--;) dat[i + 1]= y[i];\n  for (int i= 1, e= dat.size(),\
    \ j; i < e; ++i)\n   if ((j= i + (i & -i)) < e) dat[j]+= dat[i];\n }\n void add(int\
    \ i, T a= 1) {\n  for (++i; i < (int)dat.size(); i+= i & -i) dat[i]+= a;\n }\n\
    \ T sum(int i) const {  // sum [0,i)\n  T s= 0;\n  for (; i; i&= i - 1) s+= dat[i];\n\
    \  return s;\n }\n T sum(int l, int r) const { return sum(r) - sum(l); }  // sum\
    \ [l,r)\n T operator[](int k) const { return sum(k + 1) - sum(k); }\n int find(T\
    \ k) const {  // min { i : sum(i+1) > k } -> kth element(0-indexed)\n  int i=\
    \ 0;\n  for (int p= 1 << (std::__lg(dat.size() - 1) + 1), e= dat.size(); p; p>>=\
    \ 1)\n   if (i + p < e && dat[i + p] <= k) k-= dat[i+= p];\n  return i + 1 ==\
    \ (int)dat.size() ? -1 : i;  // -1 -> no solutions\n }\n};\n#line 6 \"test/yukicoder/738.BIT.test.cpp\"\
    \nusing namespace std;\nsigned main() {\n cin.tie(0);\n ios::sync_with_stdio(0);\n\
    \ int N, K;\n cin >> N >> K;\n long long A[N];\n for (int i= 0; i < N; i++) cin\
    \ >> A[i];\n vector<long long> vec(A, A + N);\n auto id= compress(vec);\n BinaryIndexedTree<long\
    \ long> bit1(vec.size()), bit2(vec.size());\n long long sum= 0;\n auto add= [&](int\
    \ i, int s) {\n  int idx= id(A[i]);\n  bit1.add(idx, s), bit2.add(idx, s * A[i]),\
    \ sum+= s * A[i];\n };\n long long ans= 1ll << 60;\n for (int i= 0; i < N; i++)\
    \ {\n  add(i, 1);\n  if (i >= K - 1) {\n   int med= bit1.find(K / 2);\n   int\
    \ lcnt= bit1.sum(med), hcnt= K - lcnt;\n   long long lsum= bit2.sum(med), hsum=\
    \ sum - lsum;\n   long long low= lcnt * vec[med] - lsum;\n   long long high= hsum\
    \ - hcnt * vec[med];\n   ans= min(ans, low + high);\n   add(i - K + 1, -1);\n\
    \  }\n }\n cout << ans << \"\\n\";\n return 0;\n}\n"
  code: "#define PROBLEM \"https://yukicoder.me/problems/no/738\"\n#include <iostream>\n\
    #include <vector>\n#include \"src/Misc/compress.hpp\"\n#include \"src/DataStructure/BinaryIndexedTree.hpp\"\
    \nusing namespace std;\nsigned main() {\n cin.tie(0);\n ios::sync_with_stdio(0);\n\
    \ int N, K;\n cin >> N >> K;\n long long A[N];\n for (int i= 0; i < N; i++) cin\
    \ >> A[i];\n vector<long long> vec(A, A + N);\n auto id= compress(vec);\n BinaryIndexedTree<long\
    \ long> bit1(vec.size()), bit2(vec.size());\n long long sum= 0;\n auto add= [&](int\
    \ i, int s) {\n  int idx= id(A[i]);\n  bit1.add(idx, s), bit2.add(idx, s * A[i]),\
    \ sum+= s * A[i];\n };\n long long ans= 1ll << 60;\n for (int i= 0; i < N; i++)\
    \ {\n  add(i, 1);\n  if (i >= K - 1) {\n   int med= bit1.find(K / 2);\n   int\
    \ lcnt= bit1.sum(med), hcnt= K - lcnt;\n   long long lsum= bit2.sum(med), hsum=\
    \ sum - lsum;\n   long long low= lcnt * vec[med] - lsum;\n   long long high= hsum\
    \ - hcnt * vec[med];\n   ans= min(ans, low + high);\n   add(i - K + 1, -1);\n\
    \  }\n }\n cout << ans << \"\\n\";\n return 0;\n}"
  dependsOn:
  - src/Misc/compress.hpp
  - src/DataStructure/BinaryIndexedTree.hpp
  isVerificationFile: true
  path: test/yukicoder/738.BIT.test.cpp
  requiredBy: []
  timestamp: '2023-01-21 16:53:05+09:00'
  verificationStatus: TEST_ACCEPTED
  verifiedWith: []
documentation_of: test/yukicoder/738.BIT.test.cpp
layout: document
redirect_from:
- /verify/test/yukicoder/738.BIT.test.cpp
- /verify/test/yukicoder/738.BIT.test.cpp.html
title: test/yukicoder/738.BIT.test.cpp
---
